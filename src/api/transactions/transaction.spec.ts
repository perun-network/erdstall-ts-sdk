// SPDX-License-Identifier: Apache-2.0
"use strict";

import "reflect-metadata";
import { describe, it } from "mocha";
import { TypedJSON } from "#erdstall/export/typedjson";
import { Call, Result, ErdstallObject } from "#erdstall/api";
import { expect } from "chai";
import { Transaction } from "./transaction";
import { Trade } from "./trade";
import { Address } from "#erdstall/ledger";
import { utils } from "ethers";
import { Transfer } from "./transfer";

describe("Wiremessages", () => {
	it("de-/encodes subscriptions", () => {
		genericJSONTest(testSubscribeTXs, Call);
		genericJSONTest(testSubscribeBalanceProofs, Call);
		genericJSONTest(testSubscribePhaseShifts, Call);
	});
	it("de-/encodes errors", () => {
		genericJSONTest(testError, Result);
	});
	it("de-/encodes exitrequests", () => {
		genericJSONTest(testExitRequest, Call);
	});
	it("de-/encodes transfers", () => {
		genericJSONTest(testTransfer, Call);
	});
	it("de-/encodes phaseshifts", () => {
		genericJSONTest(testPhaseShift, Call);
	});
	it("de-/encodes mints", () => {
		genericJSONTest(testMint, Call);
	});
	it("de-/encodes trades", () => {
		genericJSONTest(testTrade, Call);
	});
	it("trade ABI test (fees)", () => {
		// Generated randomly in go.
		const testCase: any = {
			contract: Address.fromString(
				"0x6e2FD8A6FB6caf3612967AadC749763e9657e9D1",
			),
			tradeTX: TypedJSON.parse(testTrade, Call)!
				.data as Transaction as Trade,
			tradeOfferABI:
				"0x00000000000000000000000000000000000000000000000000000000000000e00000000000000000000000006e2fd8a6fb6caf3612967aadc749763e9657e9d1000000000000000000000000853e4adb7133a2428f9110d6fe90528f952c9b8a00000000000000000000000000000000000000000000000000000000000001200000000000000000000000000000000000000000000000001d6b500e63ff2af00000000000000000000000000000000000000000000000000000000000000420000000000000000000000000000000000000000000000000000000000000062000000000000000000000000000000000000000000000000000000000000000124572647374616c6c54726164654f66666572000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000260000000000000000000000000864d521069db48e3ecc0fb37758fe390ffc52792000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000206c0586c8342049adb937086313fb85455a9c12dff262d0e450e148abac29d8cb0000000000000000000000008930626eb9d0021f4c55112252ba3d204ce042650000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000004033f7ef5bcef66ea157f22ece0b7941897c67fa4bb2fd8d1af25224e9a2d24fcef2c182b9a127700c4025f9ec0c98cc35b94d51c88aa553cfd096b97f7586e2be00000000000000000000000090a178bdf2018e4cb104b28f6276cdfa0e32f1fd0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000006038424b50e731a15664fc82bb4d7a9288a20effb7092a477a30f3eca90122c7dc5d4350a213f20b5c521a7877e09ff95d7eee15c975c8280b952a2fa57ad8bac584f9d82636fe8a455a57af682c1a88fedf173ae0c17af601496d643b09f590c9000000000000000000000000ab5e120e45085aaaaac8f81d21087c8c6cec81ce00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000020617683715581a365caf4354ecb69b248fbde705ccdbd33b6ef3048344407ea920000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000160000000000000000000000000ac15eca362aeae4876e76fbd5648130e8f123f290000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000002066cccdc1cb7da5c70669401f4b617b26a69ae3df1598d4a781f9927b6b42a5ce000000000000000000000000d26267f82969fba5d6be0986f5a505f1604107b5000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000207932032e2e9e3ca0183fa006dcf696e2263b04ab84da3c907afb98c50b3ffa0d000000000000000000000000d740ae29e3d69e2f42899e413381e1553840f72a00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000020133cfb4f6aafb36324186e6c6da8d56cf1812d048e5a39f3db714c2a195b042d000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000000800000000000000000000000006e2fd8a6fb6caf3612967aadc749763e9657e9d100000000000000000000000049ed509ee584a17987156e276f180b234e79292c00000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000114572647374616c6c5472616465466565730000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000035b7ef7803eb1a954517ee58aa9ea5964afd44ce000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000203aeb4f544769e0a8dd5ab3d2a8569336cadeb54db0af60cf79c5c13f8b1c1b86000000000000000000000000ccf0fbe58471cb5e6e4bf25fddb8f8709b24f1fc00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000020118d5931da69e0069fcb94ef71e248bb22379080bd8983dda622c7c9a59416df",
			tradeTXABI:
				"0x00000000000000000000000000000000000000000000000000000000000000c00000000000000000000000006e2fd8a6fb6caf3612967aadc749763e9657e9d1000000000000000000000000cc7b33980df2ed446b3ece6598ddd4a0373ac86f0000000000000000000000000000000000000000000000008b7b899853b7799c00000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000180000000000000000000000000000000000000000000000000000000000000000f4572647374616c6c54726164655458000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000410a608b36448f0ffb2ba265fc031cc7ec31ac44bd7185a72661afef805c8e06465fc4ccbcc4ed2790ec003dbb7584da98a264b47a553c1bbab087c882890813ce1c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000086000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000006e2fd8a6fb6caf3612967aadc749763e9657e9d1000000000000000000000000853e4adb7133a2428f9110d6fe90528f952c9b8a00000000000000000000000000000000000000000000000000000000000001200000000000000000000000000000000000000000000000001d6b500e63ff2af00000000000000000000000000000000000000000000000000000000000000420000000000000000000000000000000000000000000000000000000000000062000000000000000000000000000000000000000000000000000000000000000124572647374616c6c54726164654f66666572000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000260000000000000000000000000864d521069db48e3ecc0fb37758fe390ffc52792000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000206c0586c8342049adb937086313fb85455a9c12dff262d0e450e148abac29d8cb0000000000000000000000008930626eb9d0021f4c55112252ba3d204ce042650000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000004033f7ef5bcef66ea157f22ece0b7941897c67fa4bb2fd8d1af25224e9a2d24fcef2c182b9a127700c4025f9ec0c98cc35b94d51c88aa553cfd096b97f7586e2be00000000000000000000000090a178bdf2018e4cb104b28f6276cdfa0e32f1fd0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000006038424b50e731a15664fc82bb4d7a9288a20effb7092a477a30f3eca90122c7dc5d4350a213f20b5c521a7877e09ff95d7eee15c975c8280b952a2fa57ad8bac584f9d82636fe8a455a57af682c1a88fedf173ae0c17af601496d643b09f590c9000000000000000000000000ab5e120e45085aaaaac8f81d21087c8c6cec81ce00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000020617683715581a365caf4354ecb69b248fbde705ccdbd33b6ef3048344407ea920000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000160000000000000000000000000ac15eca362aeae4876e76fbd5648130e8f123f290000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000002066cccdc1cb7da5c70669401f4b617b26a69ae3df1598d4a781f9927b6b42a5ce000000000000000000000000d26267f82969fba5d6be0986f5a505f1604107b5000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000207932032e2e9e3ca0183fa006dcf696e2263b04ab84da3c907afb98c50b3ffa0d000000000000000000000000d740ae29e3d69e2f42899e413381e1553840f72a00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000020133cfb4f6aafb36324186e6c6da8d56cf1812d048e5a39f3db714c2a195b042d000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000000800000000000000000000000006e2fd8a6fb6caf3612967aadc749763e9657e9d100000000000000000000000049ed509ee584a17987156e276f180b234e79292c00000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000114572647374616c6c5472616465466565730000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000035b7ef7803eb1a954517ee58aa9ea5964afd44ce000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000203aeb4f544769e0a8dd5ab3d2a8569336cadeb54db0af60cf79c5c13f8b1c1b86000000000000000000000000ccf0fbe58471cb5e6e4bf25fddb8f8709b24f1fc00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000020118d5931da69e0069fcb94ef71e248bb22379080bd8983dda622c7c9a59416df",
		};
		const offer = testCase.tradeTX.offer;
		expect(offer.fees).to.exist;
		expect(utils.hexlify(offer.packTagged(testCase.contract).bytes)).eql(
			testCase.tradeOfferABI,
		);
		expect(
			utils.hexlify(testCase.tradeTX.packTagged(testCase.contract).bytes),
		).eql(testCase.tradeTXABI);
	});

	it("trade ABI test (no fees)", () => {
		// Generated randomly in go.
		const testCase: any = {
			contract: Address.fromString(
				"0x6e2FD8A6FB6caf3612967AadC749763e9657e9D1",
			),
			tradeTX: TypedJSON.parse(
				'{"sig":"0x4fda8964bb4929ed959b8efc6246686c0c851dd1b2f5ff13e7822e6a120544b5547ed6585b25e56602b616b9ac1fc640c387b329178df9bb9f8f0839a6b7c5e11b","sender":"0xcc7b33980df2ed446b3ece6598ddd4a0373ac86f","nonce":"3154030767102693157","offer":{"sig":"0x1935fa389c56ae1deb654b443bd060aa7c58ce97c26ab2bf66f6e9fb85993c1479961b5d96d4c75d80766ae921fb2c81540a5a4686ac37a319e401d031f0a83b1b","owner":"0x853e4adb7133a2428f9110d6fe90528f952c9b8a","offer":{"0x074B0E4cEA85fe6CfEaa1FA5B78aAa137b6C25bA":{"uint":"0x6a2725d52f730ffad9aeaad635512ff952da8971fc39c459e4070a8247cafd86"},"0xBB4e8bD29bbC6c51F7C6204fA131bbF5dE8C7D44":{"uint":"0x9fd4c0687e0f8e85a150bf90b77cbca7f0fec4b9cc8cd97aca91f00e874854f0"},"0xB2F30aCb3D83Eb5310796e3374bE07FcBAeaF8cF":{"uint":"0x178b5ea097edc5fc1ce84a83cb70ada998175f31bb1a81ee1545ec1f27bb9f2f"},"0x0264c08e7381e5275Db666CE3963caD731b71082":{"uint":"0x2f377d8541c4f898abb0d46aad3bc32250270c3faed5a2fc9b66eb57a835d079"}},"expiry":"3510488203188983396","request":{"0x1B8C723CFc1085deBDC8149fea278ddA2CDB7861":{"idset":["0x5208cfd459064675857e2762b5d737508c6ef48c56368cd383a80d6cb5b8ee9c","0xa03135f543d627c14826ab8d9958fb034a332424dae01c6ac25fb18b55cc6c02","0xf93f1b36d53b9f1b53ef620758d817602d6ba4046d3090816af8dc45444645ae"]},"0x63A648217cA03A44A0168d6Ca8aaF633F7c17995":{"uint":"0xd7b959541314b6b5d927cd0fb7bb286594a7e24da98ca89973db17598f0d9e60"},"0xA4608979e027ac444Cc34E2D754EE99E7d2Be147":{"uint":"0x79ede6b960bd5b7b983b935df0cd75c67a4f6335d5da5c2622a77487074ea423"}}}}',
				Trade,
			)!,
			tradeOfferABI:
				"0x00000000000000000000000000000000000000000000000000000000000000e00000000000000000000000006e2fd8a6fb6caf3612967aadc749763e9657e9d1000000000000000000000000853e4adb7133a2428f9110d6fe90528f952c9b8a000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000030b7c26be347566400000000000000000000000000000000000000000000000000000000000003c0000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000000124572647374616c6c54726164654f666665720000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000264c08e7381e5275db666ce3963cad731b71082000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000202f377d8541c4f898abb0d46aad3bc32250270c3faed5a2fc9b66eb57a835d079000000000000000000000000074b0e4cea85fe6cfeaa1fa5b78aaa137b6c25ba000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000206a2725d52f730ffad9aeaad635512ff952da8971fc39c459e4070a8247cafd86000000000000000000000000b2f30acb3d83eb5310796e3374be07fcbaeaf8cf00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000020178b5ea097edc5fc1ce84a83cb70ada998175f31bb1a81ee1545ec1f27bb9f2f000000000000000000000000bb4e8bd29bbc6c51f7c6204fa131bbf5de8c7d44000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000209fd4c0687e0f8e85a150bf90b77cbca7f0fec4b9cc8cd97aca91f00e874854f000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000001b8c723cfc1085debdc8149fea278dda2cdb7861000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000605208cfd459064675857e2762b5d737508c6ef48c56368cd383a80d6cb5b8ee9ca03135f543d627c14826ab8d9958fb034a332424dae01c6ac25fb18b55cc6c02f93f1b36d53b9f1b53ef620758d817602d6ba4046d3090816af8dc45444645ae00000000000000000000000063a648217ca03a44a0168d6ca8aaf633f7c1799500000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000020d7b959541314b6b5d927cd0fb7bb286594a7e24da98ca89973db17598f0d9e60000000000000000000000000a4608979e027ac444cc34e2d754ee99e7d2be1470000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000002079ede6b960bd5b7b983b935df0cd75c67a4f6335d5da5c2622a77487074ea4230000000000000000000000000000000000000000000000000000000000000000",
			tradeTXABI:
				"0x00000000000000000000000000000000000000000000000000000000000000c00000000000000000000000006e2fd8a6fb6caf3612967aadc749763e9657e9d1000000000000000000000000cc7b33980df2ed446b3ece6598ddd4a0373ac86f0000000000000000000000000000000000000000000000002bc55e459bcf0f2500000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000180000000000000000000000000000000000000000000000000000000000000000f4572647374616c6c54726164655458000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000411935fa389c56ae1deb654b443bd060aa7c58ce97c26ab2bf66f6e9fb85993c1479961b5d96d4c75d80766ae921fb2c81540a5a4686ac37a319e401d031f0a83b1b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000062000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000006e2fd8a6fb6caf3612967aadc749763e9657e9d1000000000000000000000000853e4adb7133a2428f9110d6fe90528f952c9b8a000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000030b7c26be347566400000000000000000000000000000000000000000000000000000000000003c0000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000000124572647374616c6c54726164654f666665720000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000264c08e7381e5275db666ce3963cad731b71082000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000202f377d8541c4f898abb0d46aad3bc32250270c3faed5a2fc9b66eb57a835d079000000000000000000000000074b0e4cea85fe6cfeaa1fa5b78aaa137b6c25ba000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000206a2725d52f730ffad9aeaad635512ff952da8971fc39c459e4070a8247cafd86000000000000000000000000b2f30acb3d83eb5310796e3374be07fcbaeaf8cf00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000020178b5ea097edc5fc1ce84a83cb70ada998175f31bb1a81ee1545ec1f27bb9f2f000000000000000000000000bb4e8bd29bbc6c51f7c6204fa131bbf5de8c7d44000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000209fd4c0687e0f8e85a150bf90b77cbca7f0fec4b9cc8cd97aca91f00e874854f000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000001b8c723cfc1085debdc8149fea278dda2cdb7861000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000605208cfd459064675857e2762b5d737508c6ef48c56368cd383a80d6cb5b8ee9ca03135f543d627c14826ab8d9958fb034a332424dae01c6ac25fb18b55cc6c02f93f1b36d53b9f1b53ef620758d817602d6ba4046d3090816af8dc45444645ae00000000000000000000000063a648217ca03a44a0168d6ca8aaf633f7c1799500000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000020d7b959541314b6b5d927cd0fb7bb286594a7e24da98ca89973db17598f0d9e60000000000000000000000000a4608979e027ac444cc34e2d754ee99e7d2be1470000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000002079ede6b960bd5b7b983b935df0cd75c67a4f6335d5da5c2622a77487074ea4230000000000000000000000000000000000000000000000000000000000000000",
		};
		const offer = testCase.tradeTX.offer;
		expect(offer.fees).to.be.undefined;
		expect(utils.hexlify(offer.packTagged(testCase.contract).bytes)).eql(
			testCase.tradeOfferABI,
		);
		expect(
			utils.hexlify(testCase.tradeTX.packTagged(testCase.contract).bytes),
		).eql(testCase.tradeTXABI);
	});
	it("de-/encodes receipts", () => {
		genericJSONTest(testTxReceipt, Result);
	});
	it("de-/encodes clientconfigs", () => {
		genericJSONTest(testClientConfig, Result);
	});
	it("de-/encodes balanceproofs", () => {
		genericJSONTest(testBalanceProofs, ErdstallObject);
	});
	it("calculates the correct hash", () => {
		const tx = TypedJSON.parse(testHashing, Transfer);
		expect(
			tx!.hash(
				Address.fromString(
					"0x3f6683210B747A318B381A5D1784A0297503287d",
				),
			),
		).to.equal(
			"0x7ad34515a46c439ddd9bd4ccd57962e538b1455b28bc626cbcb33e225dde6340",
		);
	});
});

function genericJSONTest(data: string, type: any) {
	const res = TypedJSON.parse(data, type);
	expect(JSON.parse(TypedJSON.stringify(res, type))).eql(JSON.parse(data));
}

const testBalanceProofs =
	'{"type":"BalanceProofs","data":{"0x923439be515b6a928cb9650d70000a9044e49e85":{"balance":{"epoch":"53","account":"0x923439be515b6a928cb9650d70000a9044e49e85","values":{"0x079557d7549d7d44f4b00b51d2c532674129ed51":{"uint":"0x3cfc82e37e9a7400000"}},"exit":false},"sig":"0xc93a0443d473783cf927dc1ccc17026b613ef3ceda5625c77949a07f2aa3b39253f1cc02b838e74afca27ff77e67493d9e20e1b36faf41dec442169d0d8851be1c"},"0xb5d05705c467bfed944b6769a689c7766cc1f805":{"balance":{"epoch":"53","account":"0xb5d05705c467bfed944b6769a689c7766cc1f805","values":{"0x079557d7549d7d44f4b00b51d2c532674129ed51":{"uint":"0xcff253a09503f9c00000"}},"exit":false},"sig":"0xe2cda7c66ce85bbcc25bafee085421bb38ce496f2052a05d9a78ef1238df41696b37217c4cf6c4dc885b42a6c756cbf08af7334ec5a33615d1465b62973a40c71c"}}}';

const testClientConfig =
	'{"data":{"type":"ClientConfig","data":{"networkID":"1337","contract":"0x923439be515b6a928cb9650d70000a9044e49e85","powDepth":0}}}';

const testTxReceipt =
	'{"data":{"type":"TxReceipt","data":{"tx":{"type":"Transfer","data":{"sig":"0x2192fc906c8bc20e96d3b991e427d3fac82b5703fe8998fc4610e5ae8becc22e90e745fd8db57df3eb58285ade7ec7152b0529aa2e900b5f799a6d524c178fa327","sender":"0x49d1b59c20999b5211b932c1790f278fb06daa6d","nonce":"12379802446524977118","recipient":"0x15f188fcfeb69f2379764237862ce6a68bc8faf4","values":{"0xfa7b8e5f76a994738ba781a734b654478f0e356f":{"uint":"0xc0580fcdbc2d0fde31db41d80708804b410455e71910b8b178b36b5b3c36cdd7"},"0x0bd39c3b182e8f4d8a913efb4ebf862f2712c7b3":{"idset":["0xd87165bd46a1ed84b4caa1fe4eb08f0ac5ea69660a517150ee84cf7ca6cbf58","0x331d3cb84f7ee67f0e3b5dc7c2fc21b3593aca9491c1f5d9271be5d4a47e7e4a"]},"0x610af95c3a6adecf1a436799f413d3bc094abb7e":{"idset":["0x625dfc4ecc6b7f573f586e4cd3c8504e52db8ce585d6257581b25fdff91900ef","0x715e430c2d4436d2126ac463e26e29d4703ccfc5c16f372bd841c79d9d411998","0xd6529ac4f95c19b34b8342aad7425305086c51e1e04a7982dc687d9671aede50"]}}}},"delta":{"0x359c7a524e9b01ed37658c47a8427971b611be57":{"nonce":"409354279935281384","values":{"0xa69dc83bd986f2b816ea95d2d6aee322784b0d25":{"idset":["0x74a3a7f9909f58b25ce741884fe166c8add1d6e85b96137217382942ef27015c"]},"0x68b87046afce98bb74b29b98ea82c1793bb0be5d":{"idset":["0x5a4d54fffd0c415581fcc0beea8389847b8f3236435de887838f2acb06fce89a","0x991b2188238b2c8d4ca2c2e8ebf15d5525cd34631c43599a57f6583b16d0aadb"]},"0x49849b46a19b8f1419cbcaa22ac7091594440070":{"uint":"0x2595a00ebfa027c8d9fd011909d964e0eb741b8066f0995e6e193be5e05aad59"}},"locked":{"0x737a5d52f9faf12bd39a230ef52d74d23c7d0a92":{"idset":["0x87cb36838887c2c1dbdf0da61ba01bd21ed4af3f6c9ea43929cd54bbad8e90c2","0xd827285b362d18472555140f4245a105801614a87dcf40525ad880fd3759ffd1"]},"0x7b1376abb7b7935ae48af2b37e57e665bb152ce6":{"idset":["0x129a881e0cd8de62be77f03ba37270d71bf228ba4de232fed32ac4656c122ebf","0x2f71f970bdcb8882e6eb3da735ad87fbced2cff0579fbd33e3da43e4be6b59d0","0x4643acfd16d9a31d78ff54359ce1a89f7b10419ff58460066f7768230ef6e848"]},"0xf40b9d6d863b4b7c02c622b341eb381a176c08d7":{"uint":"0x92ee5bee4ca9c5c6e668108c8e6e28d6acf5544f33a11b7a1d265094e198ff5f"}}},"0x86e68d7da44d2878a388e67375349eab6a11221d":{"nonce":"8761427733837885177","values":{"0xc96099ec39cd3f6395b57e4762b4163d91ac2bcd":{"uint":"0x8adc63222e9e328bd04f76db9ea6871021a36230fca1ebab05f1213533da5db1"},"0xf5feb6bb9c76122b39269d99c7b6c0bd41a14073":{"idset":["0xe18cd73ae1fe6cee4742c04d3958a57d900043b8d95365d414ca79ea5fd0f748","0xe82b81e890f3f7b4b1d53f216cefa89c463c594bd242b2ffc008431b7dd5e1ab"]},"0x171b5677477609b74c43235d512c7e6903c3e1cd":{"uint":"0x3f65b3b38d3daebde1768f802b4831b00a3a9c906242df71da5af91a994b86d0"}},"locked":{"0x9154f2d54a8389ca77b171275fba7d067c75cc1e":{"idset":["0x68910abbe436ad53b68c199b915c7374ccf0c50718e4b8a4e9e879c6fd8b3b3","0x6ff8b80d97ffc882c11e5028449c2de7bf137bef6a8be80248c78274987dde1"]},"0x7e5cef889f2ce1056dbae247074780471ad9f00a":{"idset":["0x401e25c76f20462a4e1d7658f4354c5cb7a59a53d34a9d8edda5d281e1f636ab","0x8ca241847d3b66c0130559c8ac992c33d61e77085416e375bc998ce6151d93a8","0xf296d176663eca5b6d850c77c1c9ad8c60b36c35574f00191657d072c97d3615"]},"0x428942514f34641691372e19eb3d6205ea29a573":{"uint":"0x2aa48565c6935dada58d13c82747869672723d4ea48f8249aa9731ed5816b00"}}},"0xd0b0f7d183be5ffc6ac5d141595cc9c386d5e958":{"nonce":"7517490549007729989","values":{"0xc1b19cfd6d15e0ead09e2f15f282857b8f7e753d":{"idset":["0x31e76acfbd21de51e51f675ad97c0eebb69b3ca6708013e71c7bffacbc370ff7","0xea715d9e9c96be73a5e7e5c9d66e22b651e65c7780d8036b4528245af056427f","0xf5ed671eaaefa768c33f395d61c12a94e989d96818e5e1fad6a4e25abf6604da"]},"0x98727781ae33fc398dd7b522eb28f941e93e17aa":{"uint":"0xc4e77dc55f11849622c2ab9c9e63cd8aef79ed3c2ef466298a28597c59dc4eb7"},"0x1ea8ecfa6c4ccb95b65586e1440bf5a18daa588f":{"uint":"0xd4dd61591524b4c258f020b2bee767e284d36d5db073ac5db1759da94a98824c"}},"locked":{"0xcfe90adc31b0473af2ba09bf9774a50adfe92048":{"uint":"0x9de45b48252378edadde4ca063b9b89433d974f6e08b1aeb9e20d0cc0dbc3877"},"0x6509395261afb1eabe6345a7e43af090cab7ef36":{"uint":"0xfcb322b3c750afd0988504a904013906c2256c975dc9550a3811509003080178"},"0x5d6cbaaf29967d74abb350ac0298fef8cbff7679":{"idset":["0x4c1fb1159cf799751b1f0bdafeebc0ed493a17e3ce5966bbb427ace8ee7af820","0x8f34ac954b16a2f6d280cf8a4f5a195937ef6d82767e46b69b999245b19df598","0xf26c927e085a45018625507012a12b13f1f6bfcc5d42b16578f07cfb04060621"]}}}},"status":13,"error":"iPl79onDjigbE25OJK"}}}';
const testTransfer =
	'{"id":"an-id","data":{"type":"Transaction","data":{"type":"Transfer","data":{"sig":"0x4702a782ed2cec2d0f6a3033b0b5cc4628da33cabf84c4c61d50ed2676eb00dd5f8738c56c1c4bb9b0372b0ac934ceff9963afc509534bef5410c67e04d946e5f6","nonce":"216021471606088551","sender":"0xaac91eb099bfedca2bb0c7c0242dd1a6533a8bad","recipient":"0x8121a1e0f4eec3ae4006699df217695e94a9bc50","values":{"0xbca5e7a4bcd379ed0a508658185804607d3e660c":{"uint":"0x1de2b278042605c0af89c122064c942730ff97a82d2a0c1bd5506818d2341241"},"0x668916e2947cb3430f586bd2c560a47cf8235c92":{"uint":"0xdb0e3b634d3c871dc7158488d50e25e860fc6daba25f39c917ed5993b32e3469"},"0x37c5dfc28c5a448ddc2868a64aad17362a6d0088":{"uint":"0x81987ded1cd1e4e1f6de6bdfa410c9815115d8cf3e131e3b010978c400a2edd5"}}}}}}';

const testExitRequest =
	'{"id":"an-id","data":{"type":"Transaction","data":{"type":"ExitRequest","data":{"sig":"0x525612193533644d30fe57e6e8e1979319b3e6eae975ed2df3252c43c3ae721476cbf9d74aef61c1294704cc00a7ec36aa6e2181127831f57d6f0518e0c459b7c0","nonce":"1863693455832366668","sender":"0x972cb3cc31ba2b845a52c6abaefcd5f09f7ba678"}}}}';

const testMint =
	'{"id":"an-id","data":{"type":"Transaction","data":{"type":"Mint","data":{"sig":"0x567f6956646dbc537ac6239f87e78416149ad102abf78f093a373ff6a283284f93853af25d07327b9135c6499c1c28fd6082be0563ddd559ac554d4a78eff61bad","nonce":"3424314417749617446","sender":"0x1be64a84d68c5cb92640eb7f64336fe5e180b676","token":"0x3c85ef52db875ca7a3ccaaedcc6fc86a25621b90","id":"123485"}}}}';

// Generated in go; do not change, because it is part of a set.
const testTrade =
	'{"id":"an-id","data":{"type":"Transaction","data":{"type":"Trade","data":{"sig":"0x91f37b5382eaa82851faf5066aac2e72a9253890c6601f3c5b33d2cce20388790e366482256e22a9e8c876d5119d1b99ac313ae53ce460fdaad74e067c9f9deb1c","sender":"0xcc7b33980df2ed446b3ece6598ddd4a0373ac86f","nonce":"10050778280739961244","offer":{"sig":"0x0a608b36448f0ffb2ba265fc031cc7ec31ac44bd7185a72661afef805c8e06465fc4ccbcc4ed2790ec003dbb7584da98a264b47a553c1bbab087c882890813ce1c","owner":"0x853e4adb7133a2428f9110d6fe90528f952c9b8a","offer":{"0x8930626eb9d0021f4c55112252ba3d204ce04265":{"idset":["0x33f7ef5bcef66ea157f22ece0b7941897c67fa4bb2fd8d1af25224e9a2d24fce","0xf2c182b9a127700c4025f9ec0c98cc35b94d51c88aa553cfd096b97f7586e2be"]},"0x90a178bdf2018e4cb104b28f6276cdfa0e32f1fd":{"idset":["0x38424b50e731a15664fc82bb4d7a9288a20effb7092a477a30f3eca90122c7dc","0x5d4350a213f20b5c521a7877e09ff95d7eee15c975c8280b952a2fa57ad8bac5","0x84f9d82636fe8a455a57af682c1a88fedf173ae0c17af601496d643b09f590c9"]},"0x864d521069db48e3ecc0fb37758fe390ffc52792":{"uint":"0x6c0586c8342049adb937086313fb85455a9c12dff262d0e450e148abac29d8cb"},"0xab5e120e45085aaaaac8f81d21087c8c6cec81ce":{"uint":"0x617683715581a365caf4354ecb69b248fbde705ccdbd33b6ef3048344407ea92"}},"expiry":"2119876072345381616","request":{"0xd26267f82969fba5d6be0986f5a505f1604107b5":{"uint":"0x7932032e2e9e3ca0183fa006dcf696e2263b04ab84da3c907afb98c50b3ffa0d"},"0xd740ae29e3d69e2f42899e413381e1553840f72a":{"uint":"0x133cfb4f6aafb36324186e6c6da8d56cf1812d048e5a39f3db714c2a195b042d"},"0xac15eca362aeae4876e76fbd5648130e8f123f29":{"uint":"0x66cccdc1cb7da5c70669401f4b617b26a69ae3df1598d4a781f9927b6b42a5ce"}},"fees":{"market":"0x49ed509ee584a17987156e276f180b234e79292c","fee":{"0x35b7ef7803eb1a954517ee58aa9ea5964afd44ce":{"idset":["0x3aeb4f544769e0a8dd5ab3d2a8569336cadeb54db0af60cf79c5c13f8b1c1b86"]},"0xccf0fbe58471cb5e6e4bf25fddb8f8709b24f1fc":{"idset":["0x118d5931da69e0069fcb94ef71e248bb22379080bd8983dda622c7c9a59416df"]}}}}}}}}';

const testPhaseShift =
	'{"id":"an-id","data":{"type":"PhaseShift","data":{"currentEpoch": "53"}}}';

const testError = '{"id":"an-id","error":"could not get proof"}';

const testSubscribeTXs =
	'{"id":"an-id","data":{"type":"SubscribeTXs","data":{"who":"0x92aaff3bba15f99960d54074ed2464c337fee0ab", "cancel": false}}}';
const testSubscribeBalanceProofs =
	'{"id":"an-id","data":{"type":"SubscribeBalanceProofs","data":{"who":"0x92aaff3bba15f99960d54074ed2464c337fee0ab", "cancel": false}}}';
const testSubscribePhaseShifts =
	'{"id":"an-id","data":{"type":"SubscribePhaseShifts","data":{"cancel": false}}}';

const testHashing =
	'{"sig":"0xb6fe6caae7123c3e1ce2640cfb914bfacb4f41b6fc2f84f406969ca668a7ebd4079c0de067ee5d323b620cc5d46d5f9fe0e12ef18feb0811b6af44af4188fd8a2d","sender":"0xe53508e4594eefa2d03a463e7d66ac640964989d","nonce":"6922120226907108202","recipient":"0xb3fd33b30f9e224d0521b79c73194150648dd300","values":{"0x6b5e665ab94af885657f1edc7674bf3a79beb68b":{"idset":["0x769765eb4327c5f82609a2ea89edc797439d3108930ec6a0ce5277d33c324f47","0xbb970d21666b218bc7efde58be7cf8c7a5ae5bad6ebef77094dcb4740e9449b0"]},"0xc6bde651b4fa5458546df0f4661d230d75ba4970":{"uint":"0xe278f34bbdb943bf627b77ba83ccb16bffef1cbbf29c2d535389776aa9d6fc7d"},"0xbe003d31ef714e903c4f8aa3785f53df1da201ac":{"idset":["0x6d222983926317836b7ae73c70e3f03b78f75356cc09da100acb5b8e712f75b2","0xbaa4daba158d05694898d7a86cf0489defa383166dd0ac3ad096d1d14ef935da","0xd1fadbdbc0f03e4d2acbe2cdda23f1acd968873571b1534ac41b8e9624703b27"]}}}';
